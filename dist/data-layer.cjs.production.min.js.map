{"version":3,"file":"data-layer.cjs.production.min.js","sources":["../src/services/fetch/fetch.ts","../src/services/converter/converter.ts","../src/api/yahoo/yahoo.ts"],"sourcesContent":["import axios, { AxiosPromise } from 'axios';\nimport { RequestConfig } from './fetch.interface';\n\nconst yahoo = axios.create({\n  baseURL: 'https://query1.finance.yahoo.com/v7/finance/download/',\n});\n\nconst apiMapper = {\n  yahoo,\n};\n\nexport const fetch = <T>({\n  api = 'yahoo',\n  url = '/',\n  method = 'GET',\n  headers = {},\n  params = {},\n  data = {},\n  ...config\n}: RequestConfig): AxiosPromise<T> => {\n  return apiMapper[api]({\n    url,\n    method,\n    headers,\n    params,\n    data,\n    ...config,\n  });\n};\n","import { ConverterInterface } from './converter.interface';\n\nexport class Converter<T extends string> implements ConverterInterface<T> {\n  constructor(private data: string | string[]) {}\n\n  toCSV() {\n    if (typeof this.data === 'string') {\n      this.data = this.data.split('\\n');\n    }\n    return this;\n  }\n\n  toJSON() {\n    if (Array.isArray(this.data)) {\n      const header = this.data[0].split(',');\n      const data = this.data.slice(1);\n      // @ts-ignore\n      this.data = data.reduce((acc, item) => {\n        const obj = {};\n\n        if (item.includes('null')) {\n          return acc;\n        }\n\n        item.split(',').forEach((val, i) => {\n          // @ts-ignore\n          obj[header[i].replace(' ', '')] = val;\n        });\n\n        return [...acc, obj];\n      }, <object[]>[]);\n\n      return this;\n    }\n    return this;\n  }\n\n  save() {\n    return this.data;\n  }\n}\n","import { GetTickerOptions, YahooInterface } from './yahoo.interface';\nimport { FetchInterface } from '../../services/fetch/fetch.interface';\n\nexport class Yahoo implements YahooInterface {\n  constructor(private readonly fetcher: FetchInterface) {}\n\n  async getTicker(\n    ticker: string,\n    {\n      period1,\n      period2,\n      interval,\n      includeAdjustedClose = 'true',\n    }: GetTickerOptions\n  ) {\n    const url = new URL(\n      `https://query1.finance.yahoo.com/v7/finance/download/${ticker}`\n    );\n    url.searchParams.set('period1', String(period1));\n    url.searchParams.set('period2', String(period2));\n    url.searchParams.set('interval', interval);\n    url.searchParams.set('includeAdjustedClose', includeAdjustedClose);\n\n    const { data } = await this.fetcher<string>({\n      url: url.toString(),\n      method: 'GET',\n    });\n\n    return data;\n  }\n}\n"],"names":["apiMapper","yahoo","axios","create","baseURL","Converter","data","this","_proto","toCSV","split","toJSON","Array","isArray","header","slice","reduce","acc","item","obj","includes","forEach","val","i","replace","save","Yahoo","fetcher","getTicker","ticker","period1","period2","interval","includeAdjustedClose","url","URL","searchParams","set","String","_context","toString","method","api","headers","params","config"],"mappings":"+hOAOMA,EAAY,CAChBC,MALYC,EAAMC,OAAO,CACzBC,QAAS,2DCFEC,aACX,WAAoBC,GAAAC,UAAAD,EADtB,kBAAA,OAAAE,EAGEC,MAAA,WAIE,MAHyB,iBAAdF,KAAKD,OACdC,KAAKD,KAAOC,KAAKD,KAAKI,MAAM,OAEvBH,MAPXC,EAUEG,OAAA,WACE,GAAIC,MAAMC,QAAQN,KAAKD,MAAO,CAC5B,IAAMQ,EAASP,KAAKD,KAAK,GAAGI,MAAM,KAC5BJ,EAAOC,KAAKD,KAAKS,MAAM,GAiB7B,OAfAR,KAAKD,KAAOA,EAAKU,QAAO,SAACC,EAAKC,GAC5B,IAAMC,EAAM,GAEZ,OAAID,EAAKE,SAAS,QACTH,GAGTC,EAAKR,MAAM,KAAKW,SAAQ,SAACC,EAAKC,GAE5BJ,EAAIL,EAAOS,GAAGC,QAAQ,IAAK,KAAOF,eAGzBL,GAAKE,OACL,IAENZ,KAET,OAAOA,MAhCXC,EAmCEiB,KAAA,WACE,OAAOlB,KAAKD,WCnCHoB,aACX,WAA6BC,GAAApB,aAAAoB,EAD/B,mBAGQC,qBAHR,kBAGE,WACEC,KADF,gBAAA,6BAAA,OAAA,sBAAA,OAAA,OAGIC,IAAAA,QACAC,IAAAA,QACAC,IAAAA,SACAC,gBAAAA,sBAAuB,UAGnBC,EAAM,IAAIC,4DAC0CN,IAEtDO,aAAaC,IAAI,UAAWC,OAAOR,IACvCI,EAAIE,aAAaC,IAAI,UAAWC,OAAOP,IACvCG,EAAIE,aAAaC,IAAI,WAAYL,GACjCE,EAAIE,aAAaC,IAAI,uBAAwBJ,GAf/CM,SAiByBhC,KAAKoB,QAAgB,CAC1CO,IAAKA,EAAIM,WACTC,OAAQ,QAnBZ,OAAA,gCAiBUnC,MAjBV,QAAA,UAAA,+BAHF,OAAA,cAAA,0FFQqB,oBACnBoC,IAAAA,aAAM,cACNR,IAAAA,aAAM,UACNO,OAAAA,aAAS,YACTE,QAAAA,aAAU,SACVC,OAAAA,aAAS,SACTtC,KAAAA,aAAO,KACJuC,0IAEH,OAAO7C,EAAU0C,MACfR,IAAAA,EACAO,OAAAA,EACAE,QAAAA,EACAC,OAAAA,EACAtC,KAAAA,GACGuC"}