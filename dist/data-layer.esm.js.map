{"version":3,"file":"data-layer.esm.js","sources":["../src/services/fetch/fetch.ts","../src/services/converter/converter.ts","../src/api/yahoo/yahoo.ts"],"sourcesContent":["import axios, { AxiosPromise } from 'axios';\nimport { RequestConfig } from './fetch.interface';\n\nconst yahoo = axios.create({\n  baseURL: 'https://query1.finance.yahoo.com/v7/finance/download/',\n});\n\nconst apiMapper = {\n  yahoo,\n};\n\nexport const fetch = <T>({\n  api = 'yahoo',\n  url = '/',\n  method = 'GET',\n  headers = {},\n  params = {},\n  data = {},\n  ...config\n}: RequestConfig): AxiosPromise<T> => {\n  return apiMapper[api]({\n    url,\n    method,\n    headers,\n    params,\n    data,\n    ...config,\n  });\n};\n","import { ConverterInterface } from './converter.interface';\n\nexport class Converter<T extends string> implements ConverterInterface<T> {\n  constructor(private data: string | string[]) {}\n\n  toCSV() {\n    if (typeof this.data === 'string') {\n      this.data = this.data.split('\\n');\n    }\n    return this;\n  }\n\n  toJSON() {\n    if (Array.isArray(this.data)) {\n      const header = this.data[0].split(',');\n      const data = this.data.slice(1);\n      // @ts-ignore\n      this.data = data.reduce((acc, item) => {\n        const obj = {};\n\n        if (item.includes('null')) {\n          return acc;\n        }\n\n        item.split(',').forEach((val, i) => {\n          // @ts-ignore\n          obj[header[i].replace(' ', '')] = val;\n        });\n\n        return [...acc, obj];\n      }, <object[]>[]);\n\n      return this;\n    }\n    return this;\n  }\n\n  save() {\n    return this.data;\n  }\n}\n","import { GetTickerOptions, YahooInterface } from './yahoo.interface';\nimport { FetchInterface } from '../../services/fetch/fetch.interface';\n\nexport class Yahoo implements YahooInterface {\n  constructor(private readonly fetcher: FetchInterface) {}\n\n  async getTicker(\n    ticker: string,\n    {\n      period1,\n      period2,\n      interval,\n      includeAdjustedClose = 'true',\n    }: GetTickerOptions\n  ) {\n    const url = new URL(\n      `https://query1.finance.yahoo.com/v7/finance/download/${ticker}`\n    );\n    url.searchParams.set('period1', String(period1));\n    url.searchParams.set('period2', String(period2));\n    url.searchParams.set('interval', interval);\n    url.searchParams.set('includeAdjustedClose', includeAdjustedClose);\n\n    const { data } = await this.fetcher<string>({\n      url: url.toString(),\n      method: 'GET',\n    });\n\n    return data;\n  }\n}\n"],"names":["yahoo","axios","create","baseURL","apiMapper","fetch","api","url","method","headers","params","data","config","Converter","toCSV","split","toJSON","Array","isArray","header","slice","reduce","acc","item","obj","includes","forEach","val","i","replace","save","Yahoo","fetcher","getTicker","ticker","period1","period2","interval","includeAdjustedClose","URL","searchParams","set","String","toString"],"mappings":"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"}